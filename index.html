<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="A powerful spreadsheet application with formulas, themes, and print support" />
  <title>Bastions Spreadsheet</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
    rel="stylesheet" />
</head>

<body>
  <div id="app">
    <!-- Toolbar -->
    <header class="toolbar" id="toolbar">
      <div class="toolbar-group toolbar-file">
        <button class="toolbar-btn" id="btn-new" title="New Spreadsheet">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
            <path d="M3 1h7l4 4v10H3V1z" stroke="currentColor" stroke-width="1.5" />
            <path d="M10 1v4h4" stroke="currentColor" stroke-width="1.5" />
          </svg>
        </button>
        <button class="toolbar-btn" id="btn-open" title="Open Spreadsheet">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
            <path d="M2 4h4l2 2h6v8H2V4z" stroke="currentColor" stroke-width="1.3" />
            <path d="M2 8h12l-2 6H4L2 8z" stroke="currentColor" stroke-width="1.3" />
          </svg>
        </button>
        <button class="toolbar-btn" id="btn-save" title="Save (Ctrl+S)">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
            <path d="M2 1h10l3 3v11H2V1z" stroke="currentColor" stroke-width="1.3" />
            <path d="M5 1v4h6V1" stroke="currentColor" stroke-width="1.3" />
            <rect x="4" y="9" width="8" height="5" rx="1" stroke="currentColor" stroke-width="1.3" />
          </svg>
        </button>
        <button class="toolbar-btn" id="btn-save-as" title="Save As...">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
            <path d="M2 1h10l3 3v11H2V1z" stroke="currentColor" stroke-width="1.3" />
            <path d="M5 1v4h6V1" stroke="currentColor" stroke-width="1.3" />
            <rect x="4" y="9" width="8" height="5" rx="1" stroke="currentColor" stroke-width="1.3" /><text x="13" y="8"
              font-size="8" fill="currentColor" font-weight="bold">+</text>
          </svg>
        </button>
        <input class="sheet-name-input" id="sheet-name" type="text" value="Untitled Spreadsheet" spellcheck="false" />
      </div>

      <div class="toolbar-divider"></div>

      <div class="toolbar-group toolbar-format">
        <select class="toolbar-select" id="font-size" title="Font Size">
          <option value="10">10</option>
          <option value="11">11</option>
          <option value="12" selected>12</option>
          <option value="14">14</option>
          <option value="16">16</option>
          <option value="18">18</option>
          <option value="20">20</option>
          <option value="24">24</option>
          <option value="28">28</option>
          <option value="32">32</option>
          <option value="36">36</option>
        </select>
        <button class="toolbar-btn" id="btn-bold" title="Bold (Ctrl+B)"><strong>B</strong></button>
        <button class="toolbar-btn" id="btn-italic" title="Italic (Ctrl+I)"><em>I</em></button>
        <button class="toolbar-btn" id="btn-underline" title="Underline (Ctrl+U)"><u>U</u></button>
        <button class="toolbar-btn" id="btn-lock" title="Lock / Unlock Cell">ğŸ”’</button>
      </div>

      <div class="toolbar-divider"></div>

      <div class="toolbar-group toolbar-align">
        <button class="toolbar-btn" id="btn-align-left" title="Align Left">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
            <path d="M2 3h12M2 6h8M2 9h10M2 12h6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
          </svg>
        </button>
        <button class="toolbar-btn" id="btn-align-center" title="Align Center">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
            <path d="M2 3h12M4 6h8M3 9h10M5 12h6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
          </svg>
        </button>
        <button class="toolbar-btn" id="btn-align-right" title="Align Right">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
            <path d="M2 3h12M6 6h8M4 9h10M8 12h6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
          </svg>
        </button>
      </div>

      <div class="toolbar-divider"></div>

      <div class="toolbar-group toolbar-colors">
        <div class="color-picker-wrapper">
          <button class="toolbar-btn color-btn" id="btn-text-color" title="Text Color">
            <span class="color-icon">A</span>
            <span class="color-indicator" id="text-color-indicator" style="background:#000000"></span>
          </button>
          <input type="color" id="text-color-input" class="hidden-color-input" value="#000000" />
        </div>
        <div class="color-picker-wrapper">
          <button class="toolbar-btn color-btn" id="btn-bg-color" title="Fill Color">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
              <rect x="2" y="2" width="12" height="12" rx="2" fill="currentColor" opacity="0.3" />
            </svg>
            <span class="color-indicator" id="bg-color-indicator" style="background:transparent"></span>
          </button>
          <input type="color" id="bg-color-input" class="hidden-color-input" value="#ffffff" />
        </div>
      </div>

      <div class="toolbar-divider"></div>

      <div class="toolbar-group toolbar-theme">
        <select class="toolbar-select" id="palette-select" title="Color Palette">
          <option value="midnight">ğŸŒ™ Midnight</option>
          <option value="parchment">ğŸ“œ Parchment</option>
          <option value="ocean">ğŸŒŠ Ocean</option>
          <option value="forest">ğŸŒ² Forest</option>
          <option value="amethyst">ğŸ’ Amethyst</option>
          <option value="monochrome">â¬› Monochrome</option>
        </select>
      </div>

      <div class="toolbar-divider"></div>

      <div class="toolbar-group toolbar-actions">
        <button class="toolbar-btn" id="btn-char-sheet" title="New D&D Character Sheet">
          âš”ï¸
        </button>
        <button class="toolbar-btn" id="btn-share" title="Share as URL">
          ğŸ“¤
        </button>
        <button class="toolbar-btn" id="btn-print" title="Print / PDF (Ctrl+P)">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
            <path d="M4 5V1h8v4M4 11H2V7h12v4h-2M4 11v4h8v-4H4z" stroke="currentColor" stroke-width="1.2" />
          </svg>
        </button>
      </div>
    </header>

    <!-- Formula Bar -->
    <div class="formula-bar" id="formula-bar">
      <div class="cell-address" id="cell-address">A1</div>
      <div class="formula-separator">
        <span class="fx-label">fx</span>
      </div>
      <input class="formula-input" id="formula-input" type="text" spellcheck="false"
        placeholder="Enter value or formula (e.g. =SUM(A1:A10))" />
    </div>

    <!-- Grid -->
    <div class="grid-wrapper" id="grid-wrapper">
      <div class="grid-container" id="grid-container">
        <!-- JS will render the grid here -->
      </div>
    </div>

    <!-- Status Bar -->
    <footer class="status-bar" id="status-bar">
      <span class="status-left" id="status-info">Ready</span>
      <span class="status-right" id="status-summary"></span>
    </footer>

    <!-- File Manager Modal -->
    <div class="modal-overlay" id="file-modal-overlay" style="display:none">
      <div class="modal" id="file-modal">
        <div class="modal-header">
          <h2 class="modal-title">Open Spreadsheet</h2>
          <button class="modal-close" id="file-modal-close">âœ•</button>
        </div>
        <div class="modal-body">
          <div class="file-list" id="file-list">
            <!-- JS populates this -->
          </div>
          <div class="file-empty" id="file-empty" style="display:none">
            <p>No saved spreadsheets yet.</p>
            <p class="file-empty-hint">Create one with the <strong>New</strong> button and it will auto-save here.</p>
          </div>
        </div>
        <div class="modal-footer">
          <button class="modal-btn modal-btn-secondary" id="file-modal-cancel">Cancel</button>
        </div>
      </div>
    </div>

    <!-- Save notification toast -->
    <div class="save-toast" id="save-toast">Saved âœ“</div>
  </div>

  <script type="module" src="/src/main.ts"></script>
</body>

</html>